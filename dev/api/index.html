<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · SpectralUnmixing.jl Documentation</title><meta name="title" content="API · SpectralUnmixing.jl Documentation"/><meta property="og:title" content="API · SpectralUnmixing.jl Documentation"/><meta property="twitter:title" content="API · SpectralUnmixing.jl Documentation"/><meta name="description" content="Documentation for SpectralUnmixing.jl Documentation."/><meta property="og:description" content="Documentation for SpectralUnmixing.jl Documentation."/><meta property="twitter:description" content="Documentation for SpectralUnmixing.jl Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="SpectralUnmixing.jl Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpectralUnmixing.jl Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Endmember-Library-Functions"><span>Endmember Library Functions</span></a></li><li><a class="tocitem" href="#Unmixing-and-Simulation-Functions"><span>Unmixing and Simulation Functions</span></a></li><li><a class="tocitem" href="#Dataset-Functions"><span>Dataset Functions</span></a></li><li><a class="tocitem" href="#Plotting-Functions"><span>Plotting Functions</span></a></li><li><a class="tocitem" href="#Solver-Functions"><span>Solver Functions</span></a></li><li class="toplevel"><a class="tocitem" href="#Utility-Functions"><span>Utility Functions</span></a></li><li class="toplevel"><a class="tocitem" href="#CLI"><span>CLI</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/emit-sds/SpectralUnmixing.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/dev/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Documentation"><a class="docs-heading-anchor" href="#API-Documentation">API Documentation</a><a id="API-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#API-Documentation" title="Permalink"></a></h1><h2 id="Endmember-Library-Functions"><a class="docs-heading-anchor" href="#Endmember-Library-Functions">Endmember Library Functions</a><a id="Endmember-Library-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Endmember-Library-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.SpectralLibrary" href="#SpectralUnmixing.SpectralLibrary"><code>SpectralUnmixing.SpectralLibrary</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct SpectralLibrary</code></pre><p>A structure for managing spectral data from a file, supporting class labels, scaling, and wavelength filtering.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L116-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.SpectralLibrary-Tuple{String, String}" href="#SpectralUnmixing.SpectralLibrary-Tuple{String, String}"><code>SpectralUnmixing.SpectralLibrary</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpectralLibrary(file_name::String,
    class_header_name::String,
    spectral_starting_column::Int64=2,
    truncate_end_columns::Int64=0,
    class_valid_keys=nothing,
    scale_factor=1.0,
    wavelength_regions_ignore=[0, 440, 1310, 1490, 1770, 2050, 2440, 2880])</code></pre><p>Constructor for the <code>SpectralLibrary</code> struct.</p><p><strong>Arguments</strong></p><ul><li><code>file_name::String</code>: Endmember Library data file name, CSV-like.</li><li><code>class_header_name::String</code>: Column for class labels in data file.</li><li><code>spectral_starting_column::Int64=2</code>: Column for start of spectral data</li><li><code>truncate_end_columns::Int64=0</code>: Number of columns to ignore from end of data.</li><li><code>class_valid_keys=nothing</code>: List of valid class labels.</li><li><code>scale_factor::Float64=1.0</code>: Spectral scaling factor.</li><li><code>wavelength_regions_ignore=[0,440,1310,1490,1770,2050,2440,2880]</code>: List of wavelength   regions to ignore as beginning/end pairs in list.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L130-L150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.load_data!" href="#SpectralUnmixing.load_data!"><code>SpectralUnmixing.load_data!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_data!(library::SpectralLibrary)</code></pre><p>Load and preprocess spectral data associated with the <code>SpectralLibrary</code> object.</p><ul><li>Load spectral data from a CSV-like file <code>library.file_name</code>.</li><li>Process wavelength ignore regions into paired sets <code>library.wavelength_regions_ignore</code>.</li><li>Load <code>library.spectra</code>, <code>library.classes</code>, and <code>library.class_valid_keys</code>.</li><li>Sort and load <code>library.wavelengths</code> as nanometers and rearrange spectral data accordingly.</li><li>Generate mask <code>library.good_bands</code> based on <code>library.wavelength_regions_ignore</code>.</li></ul><p><strong>Returns</strong></p><ul><li>The updated <code>SpectralLibrary</code> instance with loaded and processed data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L166-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.filter_by_class!" href="#SpectralUnmixing.filter_by_class!"><code>SpectralUnmixing.filter_by_class!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">filter_by_class!(library::SpectralLibrary)</code></pre><p>Filter spectra in the <code>SpectralLibrary</code> based on <code>library.class_valid_keys</code>.</p><ul><li>Update <code>library.spectra</code> and <code>library.classes</code> to include only those matching `library.</li></ul><p>class<em>valid</em>keys`.</p><p><strong>Notes</strong></p><ul><li>This function modifies the <code>library</code> in place.</li><li>If <code>library.class_valid_keys</code> is <code>nothing</code>, logs a message indicating that no filtering</li></ul><p>will occur, and exits without making any changes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L267-L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.read_envi_wavelengths" href="#SpectralUnmixing.read_envi_wavelengths"><code>SpectralUnmixing.read_envi_wavelengths</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_envi_wavelengths(filename::String, nm::Bool=true)</code></pre><p>Read wavelength data from an ENVI header file with option to convert from microns to nanometers.</p><ul><li>If no wavelengths are found, returns <code>nothing</code>.</li></ul><p><strong>Notes</strong></p><ul><li>The function constructs the expected header filename by replacing the extension of the</li></ul><p>given filename with <code>.hdr</code>.</p><ul><li>This function logs an error if no wavelength data is found in the header file.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L50-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.interpolate_library_to_new_wavelengths!" href="#SpectralUnmixing.interpolate_library_to_new_wavelengths!"><code>SpectralUnmixing.interpolate_library_to_new_wavelengths!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">interpolate_library_to_new_wavelengths!(library::SpectralLibrary, new_wavelengths::Array
{Float64})</code></pre><p>Interpolate <code>library</code> spectra to new wavelengths.</p><ul><li>Perform linear interpolation, applying a flat extrapolation boundary condition.</li><li>Update <code>library.wavelengths</code>, <code>library.good_bands</code>, and <code>library.spectra</code> matrix to the</li></ul><p>resampled spectra.</p><p><strong>Notes</strong></p><ul><li>This function modifies the <code>library</code> in place</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L316-L328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.remove_wavelength_region_inplace!" href="#SpectralUnmixing.remove_wavelength_region_inplace!"><code>SpectralUnmixing.remove_wavelength_region_inplace!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">remove_wavelength_region_inplace!(library::SpectralLibrary, set_as_nans::Bool=false)</code></pre><p>Remove wavelength regions from <code>library</code> outside <code>library.good_bands</code> either by setting them to NaN or by filtering them out.</p><p><strong>Notes</strong></p><ul><li>This function modifies the <code>library</code> in place.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L295-L303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.scale_library!" href="#SpectralUnmixing.scale_library!"><code>SpectralUnmixing.scale_library!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scale_library!(library::SpectralLibrary, scaling_factor=nothing)</code></pre><p>Scale the spectral data in the <code>SpectralLibrary</code> by the library&#39;s defined scale factor (default) or a specified scaling factor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L346-L351">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.reduce_endmembers_nmf!" href="#SpectralUnmixing.reduce_endmembers_nmf!"><code>SpectralUnmixing.reduce_endmembers_nmf!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reduce_endmembers_nmf!(library::SpectralLibrary, max_endmembers_per_class::Int64)</code></pre><p>Reduce the number of endmembers in the spectral library using Non-negative Matrix Factorization (NMF).</p><ul><li>For each class in <code>library.class_valid_keys</code>, apply NMF to the spectra subset to identify</li></ul><p>the specified maximum number of endmembers.</p><ul><li>Update <code>library.classes</code> and <code>library.spectra</code> to contain the reduced set of endmembers.</li></ul><p><strong>Notes</strong></p><ul><li>This function modifies the <code>library</code> in place.</li><li>Only <code>library.good_bands</code> will be considered in the NMF computation.</li><li>The NMF uses a maximum of 500 iterations with a tolerance of 1.0e-2 for convergence.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L412-L426">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.reduce_endmembers_kmeans!" href="#SpectralUnmixing.reduce_endmembers_kmeans!"><code>SpectralUnmixing.reduce_endmembers_kmeans!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reduce_endmembers_kmeans!(library::SpectralLibrary, max_endmembers_per_class::Int64)</code></pre><p>Reduce the number of endmembers in the spectral library using K-means clustering.</p><ul><li>For each class in <code>library.class_valid_keys</code>, apply K-means clustering to the spectra</li></ul><p>subset to identify the specified maximum number of endmembers from cluster centers.</p><ul><li>Update <code>library.classes</code> and <code>library.spectra</code> to contain the reduced set of endmembers.</li></ul><p><strong>Notes</strong></p><ul><li>This function modifies the <code>library</code> in place.</li><li>Only <code>library.good_bands</code> will be considered in the K-means computation.</li><li>The K-means algorithm is run with a maximum of 1000 iterations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L484-L497">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.reduce_endmembers_pca!" href="#SpectralUnmixing.reduce_endmembers_pca!"><code>SpectralUnmixing.reduce_endmembers_pca!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reduce_endmembers_pca!(library::SpectralLibrary, max_endmembers_per_class::Int64)</code></pre><p>Reduce the number of endmembers in the spectral library using Principal Component Analysis (PCA).</p><ul><li>For each class in <code>library.class_valid_keys</code>, apply PCA to the spectra subset to identify</li></ul><p>the specified maximum number of endmembers.</p><ul><li>Update <code>library.classes</code> and <code>library.spectra</code> to contain the reduced set of endmembers.</li></ul><p><strong>Notes</strong></p><ul><li>This function modifies the <code>library</code> in place.</li><li>Only <code>library.good_bands</code> will be considered in the PCA computation.</li><li>The PCA is truncated to <code>max_endmembers_per_class</code> PCs per endmember class.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L448-L462">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.brightness_normalize!" href="#SpectralUnmixing.brightness_normalize!"><code>SpectralUnmixing.brightness_normalize!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">brightness_normalize!(library::SpectralLibrary)</code></pre><p>Normalize <code>library.spectra</code> based on the RMS brightness of <code>library.good_bands</code>.</p><p><strong>Notes</strong></p><ul><li>This function modifies the <code>library</code> in place.</li><li>Only considers <code>library.good_bands</code> in the brightness calculation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L360-L368">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.split_library" href="#SpectralUnmixing.split_library"><code>SpectralUnmixing.split_library</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">split_library(library::SpectralLibrary, split_fraction::Float64)</code></pre><p>Split a <code>SpectralLibrary</code> into two new libraries based on a specified fraction of the total spectra.</p><p><strong>Returns</strong></p><ul><li><code>Tuple{SpectralLibrary, SpectralLibrary}</code> with each output library a random,</li></ul><p>mutually exclusive subset of the original library containing <code>split_fraction</code> and <code>1 - split_fraction</code> of the spectra, respectively.</p><p><strong>Notes</strong></p><ul><li>The split is random; consecutive calls with the same <code>library</code> may yield different</li></ul><p>results.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L374-L388">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.prepare_combinations" href="#SpectralUnmixing.prepare_combinations"><code>SpectralUnmixing.prepare_combinations</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_combinations(library::SpectralLibrary, combination_type::String)</code></pre><p>Prepare the set of class indices for the specified combination type.</p><ul><li>Currently only supports <code>&quot;class-even&quot;</code>: returns the list of indices grouped by class.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/SpectralUnmixing.jl#L379-L385">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.prepare_options" href="#SpectralUnmixing.prepare_options"><code>SpectralUnmixing.prepare_options</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_options(library::SpectralLibrary, combination_type::String,
                 num_endmembers::Vector{Int64}, class_idx)</code></pre><p>Prepare combinations of endmembers based on the specified combination type.</p><ul><li>Combination type options:<ul><li><code>&quot;class-even&quot;</code>`: Generate all combinations where one endmember is selected from each class.</li><li><code>&quot;all&quot;</code>: Generate all possible combinations of <code>num_endmembers</code> spectra.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/SpectralUnmixing.jl#L396-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.scale_data" href="#SpectralUnmixing.scale_data"><code>SpectralUnmixing.scale_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scale_data(refl::Matrix{Float64}, wavelengths::Vector{Float64}, criteria::String,
    bad_regions_wl=[[1300, 1500], [1800, 2000]])</code></pre><p>Scale the reflectance data based on specified criteria.</p><p><strong>Arguments</strong></p><ul><li><code>refl::Matrix{Float64}</code>: Reflectance data either size (n,) or (m,n), where n is the</li></ul><p>number of bands and m the number of pixels.</p><ul><li><code>wavelengths::Vector{Float64}</code>: A vector of wavelengths of size (n,).</li><li><code>criteria::String</code>: Normalization options:<ul><li><code>&quot;none&quot;</code>: No scaling will be applied, and the original reflectance data will be</li></ul>returned.<ul><li><code>&quot;brightness&quot;</code>: The data will be normalized based on brightness, excluding specified</li></ul>bad wavelength regions [1300, 1500] and [1800, 2000].<ul><li>A specific wavelength (as a string): The data will be normalized using the reflectance</li></ul>value at this wavelength.</li><li><code>bad_regions_wl</code>=[[1300, 1500], [1800, 2000]]: List of wavelength regions (in nm) to</li></ul><p>ignore.</p><p><strong>Returns</strong></p><ul><li>A matrix of scaled reflectance data with same dimensions as <code>refl</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/SpectralUnmixing.jl#L62-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.get_good_bands_mask" href="#SpectralUnmixing.get_good_bands_mask"><code>SpectralUnmixing.get_good_bands_mask</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_good_bands_mask(wavelengths::Array{Float64}, wavelength_pairs)</code></pre><p>Return a boolean mask for <code>wavelengths</code> <em>outside</em> the specified wavelength ranges given by <code>wavelength_pairs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L94-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.save_data" href="#SpectralUnmixing.save_data"><code>SpectralUnmixing.save_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_data(library::SpectralLibrary, output_filename::String;
class_label_name::String=&quot;Label&quot;)</code></pre><p>Wrte the spectra and classes from a <code>SpectralLibrary</code> to a CSV file.</p><ul><li>The output CSV will have the class labels as the first column under <code>class_label_name</code>,</li></ul><p>followed by columns for each wavelength with the spectra values filling the corresponding rows.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L246-L255">source</a></section></article><h2 id="Unmixing-and-Simulation-Functions"><a class="docs-heading-anchor" href="#Unmixing-and-Simulation-Functions">Unmixing and Simulation Functions</a><a id="Unmixing-and-Simulation-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Unmixing-and-Simulation-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.unmix_pixel" href="#SpectralUnmixing.unmix_pixel"><code>SpectralUnmixing.unmix_pixel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unmix_pixel(library::SpectralLibrary, img_dat_input::Array{Float64}, unc_dat,
            class_idx, options, mode::String, n_mc::Int64,
            num_endmembers::Vector{Int64}, normalization::String, optimization::String,
            max_combinations::Int64, combination_type::String)</code></pre><p>Unmix a pixel&#39;s spectral data using a given spectral library with options for SMA or MESMA and various Monte Carlo and optimization approaches.</p><p><strong>Arguments</strong></p><ul><li><code>library::SpectralLibrary</code>: Endmember library for unmixing.</li><li><code>img_dat_input::Array{Float64}</code>: Spectral data of the pixel.</li><li><code>unc_dat</code>: An optional array of uncertainty in the pixel spectral data.</li><li><code>class_idx</code>: A collection of indices indicating class memberships for different</li></ul><p>endmembers in <code>library.spectra</code>. See also <a href="#SpectralUnmixing.prepare_combinations"><code>prepare_combinations</code></a>, <a href="#SpectralUnmixing.prepare_options"><code>prepare_options</code></a></p><ul><li><code>options</code>: A collection of potential endmember combinations for the unmixing process. See</li></ul><p>also <a href="#SpectralUnmixing.prepare_options"><code>prepare_options</code></a>.</p><ul><li><code>mode::String</code>: Determines the unmixing approach:<ul><li><code>&quot;sma&quot;</code>: Select endmembers randomly for MC unmixing, returns mean fractions.</li><li><code>&quot;sma-best&quot;</code>: SMA and output best (lowest cost) MC fraction.</li><li><code>&quot;mesma&quot;</code>: Evaluate different combinations of endmembers representing each class.</li><li><code>&quot;mesma-best&quot;</code>: MESMA and output best (lowest cost) MC fraction.</li></ul></li><li><code>n_mc::Int64</code>: Number of MC iterations.</li><li><code>num_endmembers::Vector{Int64}</code>: The number of endmembers to consider.</li><li><code>normalization::String</code>: The normalization method to apply to the spectral data. See</li></ul><p><a href="#SpectralUnmixing.scale_data"><code>scale_data</code></a>.</p><ul><li><code>optimization::String</code>: The optimization approach for unmixing: (e.g., <code>&quot;bvls&quot;</code>,</li></ul><p><code>&quot;ldsqp&quot;</code>, or <code>&quot;inverse&quot;</code>). Can optionally contain <code>&quot;pinv&quot;</code> or <code>&quot;qr&quot;</code> to specify the inverse method, if applicable.</p><ul><li><code>max_combinations::Int64</code>: Maximum number of combinations to consider.</li><li><code>combination_type::String</code>: The type of combination (e.g., <code>&quot;class-even&quot;</code>). See also</li></ul><p><a href="#SpectralUnmixing.prepare_combinations"><code>prepare_combinations</code></a>, <a href="#SpectralUnmixing.prepare_options"><code>prepare_options</code></a>, <a href="#SpectralUnmixing.get_sma_permutation"><code>get_sma_permutation</code></a>.</p><p><strong>Returns</strong></p><ul><li>A tuple containing:<ul><li><code>output_mixture::Vector{Float64}</code>: The estimated fraction of each class in the</li></ul><code>library</code>, appended with the brightness.<ul><li><code>output_mixture_var::Vector{Float64}</code>: The variance of each class in the <code>library</code>,</li></ul>appended with the brightness variance.<ul><li><code>output_comp_frac::Vector{Float64}</code>: The estimated fraction of each endmember in the</li></ul><code>library</code>, appended with the brightness.<ul><li><code>output_comp_frac_var::Vector{Float64}</code>: The variance of each endmember in the</li></ul><code>library</code>, appended with the brightness variance.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/SpectralUnmixing.jl#L211-L255">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.simulate_pixel" href="#SpectralUnmixing.simulate_pixel"><code>SpectralUnmixing.simulate_pixel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_pixel(library::SpectralLibrary, max_components::Int64,
                combination_type::String, seed::Int64)</code></pre><p>Simulate reflectance data for a pixel from a random normalized distribution of endmembers in <code>library</code>.</p><p><strong>Arguments</strong></p><ul><li><code>library::SpectralLibrary</code>: Spectral library containing endmembers and class</li></ul><p>information.</p><ul><li><code>max_components::Int64</code>: Maximum number of endmembers to use in the simulation.</li><li><code>combination_type::String</code>: The type of combinations to consider when selecting</li></ul><p>endmembers (e.g., &quot;all&quot; or &quot;class-even&quot;).</p><ul><li><code>seed::Int64</code>: Seed for the random number generator.</li></ul><p><strong>Returns</strong></p><ul><li>A tuple containing:<ul><li><code>simulated_rfl</code>: Simulated reflectance spectrum of the pixel.</li><li><code>output_distribution</code>: A vector of endmember contributions for the pixel.</li><li><code>output_distribution_classes</code>: A vector of contributions of each unique class.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/SpectralUnmixing.jl#L574-L594">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.unmix_line" href="#SpectralUnmixing.unmix_line"><code>SpectralUnmixing.unmix_line</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unmix_line(line::Int64, reflectance_file::String, mode::String,
            refl_nodata::Float64, refl_scale::Float64,
            normalization::String, library::SpectralLibrary,
            reflectance_uncertainty_file::String=&quot;&quot;, n_mc::Int64=1,
            combination_type::String=&quot;all&quot;,
            num_endmembers::Vector{Int64}=[2, 3],
            max_combinations::Int64=-1, optimization=&quot;bvls&quot;)</code></pre><p>Unmix a specific line (row of pixels) of reflectance data. See also <a href="#SpectralUnmixing.load_line"><code>load_line</code></a>, <a href="#SpectralUnmixing.unmix_pixel"><code>unmix_pixel</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>line::Int64</code>: Index of the line to unmix.</li><li><code>reflectance_file::String</code>: Path to the reflectance data.</li><li><code>mode::String</code>: The mode of unmixing to be used (e.g., &quot;sma&quot;, &quot;mesma-best&quot;). See</li></ul><p><a href="#SpectralUnmixing.unmix_pixel"><code>unmix_pixel</code></a>).</p><ul><li><code>refl_nodata::Float64</code>: The no data value in the reflectance file.</li><li><code>refl_scale::Float64</code>: Scaling factor for the reflectance data.</li><li><code>normalization::String</code>: The normalization method to apply to the reflectance data. See</li></ul><p><a href="#SpectralUnmixing.scale_data"><code>scale_data</code></a>.</p><ul><li><code>library::SpectralLibrary</code>: Spectral library object containing endmembers for unmixing.</li><li><code>reflectance_uncertainty_file::String</code>: Optional path to the reflectance uncertainty file.</li><li><code>n_mc::Int64=1</code>: Number of Monte Carlo iterations to perform.</li><li><code>combination_type::String=&quot;all&quot;</code>: The type of endmember combinations to prepare for</li></ul><p>unmixing. See also <a href="#SpectralUnmixing.prepare_combinations"><code>prepare_combinations</code></a>, <a href="#SpectralUnmixing.prepare_options"><code>prepare_options</code></a>.</p><ul><li><code>num_endmembers::Vector{Int64}=[2, 3]</code>: The number of endmembers to consider in</li></ul><p>combinations.</p><ul><li><code>max_combinations::Int64=-1</code>: Maximum number of combinations to consider, defaults to no</li></ul><p>limit.</p><ul><li><code>optimization::String</code>: The optimization method to use (default is &quot;bvls&quot;). See also</li></ul><p><a href="#SpectralUnmixing.unmix_pixel"><code>unmix_pixel</code></a>.</p><p><strong>Returns</strong></p><ul><li>A tuple containing (see also <a href="#SpectralUnmixing.unmix_pixel"><code>unmix_pixel</code></a>):<ul><li>The line index.</li><li>Estimated class fractions for each pixel in the line.</li><li>A boolean mask of pixels with valid data.</li><li>Standard deviations of the mixture results (if applicable).</li><li>Complete fractions for each endmember in the unmixing of each pixel.</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>Initializes a random seed for reproducibility.</li><li>Logs the execution time for unmixing a line.</li><li>Returns <code>nothing</code> if input data is invalid or missing.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/SpectralUnmixing.jl#L425-L470">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.unmix_and_write_line" href="#SpectralUnmixing.unmix_and_write_line"><code>SpectralUnmixing.unmix_and_write_line</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unmix_and_write_line(line::Int64, reflectance_file::String, mode::String,
                      refl_nodata::Float64, refl_scale::Float64,
                      normalization::String, library::SpectralLibrary,
                      output_files::Vector{String}, write_complete_fractions::Bool,
                      reflectance_uncertainty_file::String=&quot;&quot;, n_mc::Int64=1,
                      combination_type::String=&quot;all&quot;,
                      num_endmembers::Vector{Int64}=[2, 3],
                      max_combinations::Int64=-1, optimization=&quot;bvls&quot;)</code></pre><p>Unmix the specified <code>line</code> of <code>reflectance_file</code> and write the results to <code>output_files</code>. Workhorse function for <code>unmix.jl</code>.</p><ul><li>See [<code>unmix_line</code>(@ref)] and <a href="#SpectralUnmixing.write_line_results"><code>write_line_results</code></a> for arguments.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/SpectralUnmixing.jl#L544-L558">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.get_sma_permutation" href="#SpectralUnmixing.get_sma_permutation"><code>SpectralUnmixing.get_sma_permutation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sma_permutation(class_idx, num_endmembers::Vector{Int64},
                    combination_type::String, library_length::Int64)</code></pre><p>Generate a permutation of endmember indices for SMA.</p><p><strong>Arguments</strong></p><ul><li><code>class_idx</code>: A collection (such as a vector of vectors) of size n where each element</li></ul><p>is a set of indices corresponding to endmembers belonging to one class.</p><ul><li><code>num_endmembers::Vector{Int64}</code>: Desired number of endmembers to select. The first</li></ul><p>element specifies the number of endmembers to permute; if it is <code>-1</code>, all endmembers in library will be included.</p><ul><li><code>combination_type::String</code>: Permutation type options:<ul><li><code>&quot;class-even&quot;</code>: Randomly select one endmember from each class until the required number</li></ul>of endmembers is selected.<ul><li>Any other types: Randomly selects endmembers from the entire library.</li></ul></li><li><code>library_length::Int64</code>: Size of the entire endmember library.</li></ul><p><strong>Returns</strong></p><ul><li>A vector of integers representing the permuted endmember indices.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/SpectralUnmixing.jl#L117-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.results_from_mc" href="#SpectralUnmixing.results_from_mc"><code>SpectralUnmixing.results_from_mc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">results_from_mc(results::Matrix{Float64}, cost::Vector{Float64}, mode::String)</code></pre><p>Process Monte Carlo simulations and return variance and result based on <code>mode</code>.</p><p><strong>Arguments</strong></p><ul><li><code>results::Matrix{Float64}</code>: Outcomes of MC simulations, where each row represents a</li></ul><p>simulation and each column corresponds to a different variable.</p><ul><li><code>cost::Vector{Float64}</code>: A vector of Float64 values representing the cost associated</li></ul><p>with each simulation, used to determine the best result when applicable.</p><ul><li><code>mode::String</code>: How to process the results. It can be:<ul><li>Contain <code>&quot;best&quot;</code>: Returns the result corresponding to the simulation with the lowest</li></ul>cost.<ul><li>Any other value: Computes and returns the mean of the results across all simulations.</li></ul></li></ul><p><strong>Returns</strong></p><ul><li>A tuple containing:<ul><li><code>output::Vector{Float64}</code>: MC simulation results</li><li><code>output_var::Vector{Float64}</code>: Standard deviation of the results for each variable, or</li></ul><code>nothing</code> if there is only one simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/SpectralUnmixing.jl#L172-L192">source</a></section></article><h2 id="Dataset-Functions"><a class="docs-heading-anchor" href="#Dataset-Functions">Dataset Functions</a><a id="Dataset-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Dataset-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.initiate_output_datasets" href="#SpectralUnmixing.initiate_output_datasets"><code>SpectralUnmixing.initiate_output_datasets</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initiate_output_datasets(output_files::Vector{String}, x_len::Int64, y_len::Int64,
                         output_bands::Vector, reference_dataset::ArchGDAL.IDataset)</code></pre><p>Initialize multiple output raster datasets in ENVI format with specified dimensions and band information using a reference dataset for projection and geotransformation.</p><p><strong>Arguments</strong></p><ul><li><code>output_files::Vector{String}</code>: File paths of the output datasets. Each entry corresponds</li></ul><p>to a separate output raster.</p><ul><li><code>x_len::Int64</code>: Width of the output datasets.</li><li><code>y_len::Int64</code>: Height of the output datasets.</li><li><code>output_bands::Vector</code>: Number of bands for each output dataset. The length of this</li></ul><p>vector must match the length of <code>output_files</code>.</p><ul><li><code>reference_dataset::ArchGDAL.IDataset</code>: Reference dataset object from which projection</li></ul><p>and geotransformation information will be copied.</p><p><strong>Notes</strong></p><ul><li>All bands in the output datasets are initialized with the no-data value of <code>-9999</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Datasets.jl#L40-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.set_band_names" href="#SpectralUnmixing.set_band_names"><code>SpectralUnmixing.set_band_names</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_band_names(filename::String, band_names::Vector)</code></pre><p>Set the names of the bands in a raster dataset specified by the given filename.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code>: Path to the raster file. The file must be in a format supported by</li></ul><p>GDAL. The data file is updated in place.</p><ul><li><code>band_names::Vector</code>: A vector of strings containing the new names for each band in the</li></ul><p>raster dataset. The length of this vector must match the number of bands in the raster.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Datasets.jl#L20-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.write_results" href="#SpectralUnmixing.write_results"><code>SpectralUnmixing.write_results</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_results(output_files::Vector{String}, output_bands::Vector, x_len::Int64,
              y_len::Int64, results, args)</code></pre><p>Write processed results to specified output ENVI raster files, including primary outputs, uncertainty estimates, and complete fractions, based on the provided parameters.</p><p><strong>Arguments</strong></p><ul><li><code>output_files::Vector{String}</code>: File paths of the output datasets to be created or</li></ul><p>updated. Each entry corresponds to a separate output raster.</p><ul><li><code>output_bands::Vector</code>: Number of bands for each output dataset. The length of this</li></ul><p>vector must match the number of output files.</p><ul><li><code>x_len::Int64</code>: Width of the output datasets.</li><li><code>y_len::Int64</code>: Height of the output datasets.</li><li><code>results</code>: A collection of results, where each result is expected to be a tuple or</li></ul><p>similar structure. Specific elements contain the data to be written to the output datasets.</p><ul><li><code>args</code>: An object or structure containing additional parameters that dictate the</li></ul><p>writing behavior. Available options are:     - <code>args.n_mc</code>: If greater than 1, an uncertainty output is also written to the second     output file.     - <code>args.write_complete_fractions</code>: If set to 1, write complete fractions to the     subsequent output file.</p><p><strong>Notes</strong></p><ul><li>The primary output is initialized with a no-data value of <code>-9999</code> and written to the first output file specified in <code>output_files</code>.</li><li>Each output array is permuted to match the desired dimensions before writing.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Datasets.jl#L93-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.write_line_results" href="#SpectralUnmixing.write_line_results"><code>SpectralUnmixing.write_line_results</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_line_results(output_files::Vector{String}, results, n_mc::Int64,
                   write_complete_fractions::Bool)</code></pre><p>Write line-based <a href="#SpectralUnmixing.unmix_line"><code>unmix_line</code></a> results to specified output ENVI raster files.</p><p><strong>Arguments</strong></p><ul><li><code>output_files::Vector{String}</code>: File paths of the output datasets to be created or</li></ul><p>updated. The first entry is for pixel mixture fractions, subsequent entries are for uncertainty and complete fractions, in that order, if applicable.</p><ul><li><code>results</code>: Results to be written, as produced by <a href="#SpectralUnmixing.unmix_line"><code>unmix_line</code></a>.</li><li><code>n_mc::Int64</code>: If greater than one, uncertainty outputs will be written to the</li></ul><p>subsequent output file.</p><ul><li><code>write_complete_fractions::Bool</code>: Indicates whether to write complete fractions</li></ul><p>to the subsequent output file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Datasets.jl#L180-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.load_line" href="#SpectralUnmixing.load_line"><code>SpectralUnmixing.load_line</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_line(reflectance_file::String, reflectance_uncertainty_file::String,
           line::Int64, good_bands::Array{Bool}, refl_nodata::Float64)</code></pre><p>Load a specific line (row) of reflectance data and its associated uncertainty from raster files, filtering based on specified good bands and no-data values.</p><p><strong>Arguments</strong></p><ul><li><code>reflectance_file::String</code>: Path to the ENVI reflectance raster file.</li><li><code>reflectance_uncertainty_file::String</code>: Path to the uncertainty raster file corresponding</li></ul><p>to the reflectance data. An empty string indicates no uncertainty data.</p><ul><li><code>line::Int64</code>: Line (row) of the raster data to be loaded.</li><li><code>good_bands::Array{Bool}</code>: Boolean array indicating which bands of the data to keep and</li></ul><p>process.</p><ul><li><code>refl_nodata::Float64</code>: The no-data value used in the reflectance data.</li></ul><p><strong>Returns</strong></p><ul><li>A tuple containing:<ul><li><code>img_dat::Array{Float64}</code>: The filtered reflectance data for the specified line and</li></ul>good bands. If no valid data exists, this will be <code>nothing</code>.<ul><li><code>unc_dat::Array{Float64}</code>: The uncertainty data, filtered similarly. If no uncertainty</li></ul>data is loaded or valid, this will be <code>nothing</code>.<ul><li><code>good_data</code>: A boolean array indicating which pixels contain valid reflectance data.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Datasets.jl#L250-L273">source</a></section></article><h2 id="Plotting-Functions"><a class="docs-heading-anchor" href="#Plotting-Functions">Plotting Functions</a><a id="Plotting-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.plot_mean_endmembers" href="#SpectralUnmixing.plot_mean_endmembers"><code>SpectralUnmixing.plot_mean_endmembers</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_mean_endmembers(endmember_library::SpectralLibrary; output_name::String=&quot;&quot;)</code></pre><p>Plot the mean spectra of endmembers of each class from a spectral library.</p><ul><li>Saves file to <code>output_name</code> if provided, otherwise defaults to no saving.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Plotting.jl#L20-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.plot_endmembers" href="#SpectralUnmixing.plot_endmembers"><code>SpectralUnmixing.plot_endmembers</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_endmembers(endmember_library::SpectralLibrary; output_name::String=&quot;&quot;)</code></pre><p>Plot all endmember spectra from a spectral library.</p><ul><li>Endmember spectra are colored and labeled by class.</li><li>Saves file to <code>output_name</code> if provided, otherwise defaults to no saving.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Plotting.jl#L44-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.plot_endmembers_individually" href="#SpectralUnmixing.plot_endmembers_individually"><code>SpectralUnmixing.plot_endmembers_individually</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_endmembers_individually(endmember_library::SpectralLibrary;
output_name::String=&quot;&quot;, legend_on::Bool=false)</code></pre><p>Plot all endmember spectra individually from a spectral library, grouped by class.</p><ul><li>Create seperate plots for each class, legends are disabled by default.</li><li>Saves file to <code>output_name</code> if provided, otherwise defaults to no saving.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Plotting.jl#L83-L91">source</a></section></article><h2 id="Solver-Functions"><a class="docs-heading-anchor" href="#Solver-Functions">Solver Functions</a><a id="Solver-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Solver-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.opt_solve" href="#SpectralUnmixing.opt_solve"><code>SpectralUnmixing.opt_solve</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">opt_solve(A::Matrix{Float64}, b::Vector{Float64}, x0::Vector{Float64},
lb::Vector{Float64}, ub::Vector{Float64})</code></pre><p>Solve a nonlinear least squares problem, finding the vector <code>x</code> subject to lower (<code>lb</code>) and upper (<code>ub</code>) bounds, that minimizes the residual ||Ax - b||² using the NLopt library&#39;s implementation of the SLSQP algorithm.</p><p><strong>Arguments</strong></p><ul><li><code>A::Matrix{Float64}</code>: Coefficient matrix of size (m, n).</li><li><code>b::Vector{Float64}</code>: Target vector of size (m,).</li><li><code>x0::Vector{Float64}</code>: Initial guess vector of size (n,) for the optimization variables.</li></ul><p>Values will be clipped to the range [0, 1].</p><ul><li><code>lb::Vector{Float64}</code>: Vector of size (n,) specifying the lower bounds for the</li></ul><p>optimization variables.</p><ul><li><code>ub::Vector{Float64}</code>: Vector of size (n,) specifying the upper bounds for the</li></ul><p>optimization variables.</p><p><strong>Returns</strong></p><ul><li>A tuple containing:<ul><li><code>x</code>: The optimized values of the variables <code>x</code> (vector of size (n,)).</li><li><code>mse_opt</code>: The exponential of the objective function value at the optimum.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Solvers.jl#L21-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.dolsq" href="#SpectralUnmixing.dolsq"><code>SpectralUnmixing.dolsq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dolsq(A, b; method::String=&quot;default&quot;)</code></pre><p>Solve a least squares problem, finding the vector <code>x</code> that minimizes the residual ||Ax - b||².</p><p><strong>Arguments</strong></p><ul><li><code>A</code>: Coefficient matrix of size (m, n).</li><li><code>b</code>: Target vector of size (m,).</li><li><code>method</code>: An optional keyword argument specifying the solver method.</li></ul><p>Available options are:     - <code>&quot;default&quot;</code>: Solve the system using the backslash operator (`<code>).     -</code>&quot;pinv&quot;<code>: Use the pseudoinverse of</code>A<code>to compute the solution.     -</code>&quot;qr&quot;`: Use QR decomposition to solve the least squares problem.</p><p><strong>Returns</strong></p><ul><li><code>x</code>: Vector of size (n,) that minimizes the least squares residual.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Solvers.jl#L69-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.bvls" href="#SpectralUnmixing.bvls"><code>SpectralUnmixing.bvls</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bvls(A, b, x_lsq, lb, ub, tol::Float64, max_iter::Int64, verbose::Int64,
     inverse_method::String)</code></pre><p>Solve a bounded value least squares problem, finding the vector <code>x</code> subject to lower (<code>lb</code>) and upper (<code>ub</code>) bounds, that minimizes the residual ||Ax - b||².</p><ul><li>The function employs an iterative approach, adjusting the solution based on the specified bounds.</li><li>Convergence is determined by whether KKT optimality condition (see</li></ul><p><a href="#SpectralUnmixing.compute_kkt_optimality"><code>compute_kkt_optimality</code></a>) is within the specified tolerance.</p><p><strong>Arguments</strong></p><ul><li><code>A</code>: Coefficient matrix of size (m, n).</li><li><code>b</code>: Target vector of size (m,).</li><li><code>x_lsq</code>: Initial guess vector of size (n,) for the optimization variables.</li><li><code>lb</code>: Vector of size (n,) specifying the lower bounds for the</li></ul><p>optimization variables.</p><ul><li><code>ub</code>: Vector of size (n,) specifying the upper bounds for the</li></ul><p>optimization variables.</p><ul><li><code>tol::Float64</code>: Tolerance for convergence of the optimization.</li><li><code>max_iter::Int64</code>: Maximum number of iterations allowed. If not specified, defaults to n.</li><li><code>verbose::Int64</code>: Verbosity of output (0, 1, or 2).</li><li><code>inverse_method::String</code>: Least squares solver method, see <a href="#SpectralUnmixing.dolsq"><code>dolsq</code></a> for options.</li></ul><p><strong>Returns</strong></p><ul><li>A tuple containing:<ul><li><code>x</code>: Vector of size (n,) that minimizes the least squares residual.</li><li><code>cost</code>: The final cost function value of the minimized sum of squared residuals.</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>Reference:  https://www.stat.berkeley.edu/~stark/Preprints/bvls.pdf</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Solvers.jl#L101-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.compute_kkt_optimality" href="#SpectralUnmixing.compute_kkt_optimality"><code>SpectralUnmixing.compute_kkt_optimality</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_kkt_optimality(g::Vector{Float64}, on_bound::Vector)</code></pre><p>Computes the Karush-Kuhn-Tucker (KKT) optimality condition value for a given gradient vector and a vector indicating which variables are on bounds.</p><ul><li>Returns a value representing the maximum KKT condition across all variables</li></ul><p><strong>Arguments</strong></p><ul><li><code>g</code>: A vector of size (n,) representing the gradient of the objective function at the current point.</li><li><code>on_bound</code>: A vector of size (n,) indicating the status of each variable:<ul><li><code>-1</code> if the variable is at its lower bound,</li><li><code>1</code> if the variable is at its upper bound,</li><li><code>0</code> if the variable is free (not constrained).</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/Solvers.jl#L306-L321">source</a></section></article><h1 id="Utility-Functions"><a class="docs-heading-anchor" href="#Utility-Functions">Utility Functions</a><a id="Utility-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-Functions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.wl_index" href="#SpectralUnmixing.wl_index"><code>SpectralUnmixing.wl_index</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wl_index(wavelengths::Vector{Float64}, target::Float64)</code></pre><p>Return the index of the wavelength in a vector that is closest to the specified target wavelength.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/SpectralUnmixing.jl#L52-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.nanargmax" href="#SpectralUnmixing.nanargmax"><code>SpectralUnmixing.nanargmax</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nanargmin(input::Array)</code></pre><p>Return the index of the minimum value in the input array, ignoring NaN values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.nanargmin" href="#SpectralUnmixing.nanargmin"><code>SpectralUnmixing.nanargmin</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nanargmin(input::Array)</code></pre><p>Return the index of the maximum value in the input array, ignoring NaN values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/EndmemberLibrary.jl#L39-L43">source</a></section></article><h1 id="CLI"><a class="docs-heading-anchor" href="#CLI">CLI</a><a id="CLI-1"></a><a class="docs-heading-anchor-permalink" href="#CLI" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralUnmixing.CLI.install" href="#SpectralUnmixing.CLI.install"><code>SpectralUnmixing.CLI.install</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">install(; dest_dir::String=joinpath(DEPOT_PATH[1], &quot;bin&quot;),
    sym_name::String=&quot;unmix.jl&quot;)</code></pre><p>Create a symlink to the <code>unmix.jl</code> CLI script.</p><p><strong>Arguments</strong></p><ul><li><code>dest_dir::String</code>: The directory where the symlink will be created (default: <code>~/.julia/bin</code>).</li><li><code>sym_name::String</code>: The name of the symlink to be created (default: <code>unmix.jl</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emit-sds/SpectralUnmixing.jl/blob/8ab728ccbc15724bd8aed87034b02a7f3b74e825/src/CLI.jl#L5-L14">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../contributing/">« Contributing</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Friday 20 June 2025 22:42">Friday 20 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
